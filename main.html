<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Main</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0f172a;
      color: white;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    .sidebar {
      width: 220px;
      background: #1e293b;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      border-right: 2px solid #334155;
    }
    .sidebar h2 {
      margin-bottom: 1rem;
    }
    .sidebar button {
      margin: 0.5rem 0;
      padding: 0.8rem;
      border: none;
      border-radius: 8px;
      background: #334155;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      transition: 0.3s;
    }
    .sidebar button:hover {
      background: #475569;
    }
    .iframe-container {
      flex-grow: 1;
      position: relative;
      background: #0f172a;
    }
    iframe {
      position: absolute;
      top: 0;
      right: -100%;
      width: 100%;
      height: 100%;
      border: none;
      border-radius: 16px 0 0 16px;
      transition: right 0.5s ease;
    }
    iframe.open { right: 0; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2 id="username">User</h2>
    <button onclick="openIframe('https://9f2bb2c8343f.ngrok-free.app/')">ðŸŽµ Music</button>
    <button onclick="window.open('https://play.geforcenow.com', '_blank')">ðŸŽ® GeForce Now</button>
    <button onclick="window.open('https://discord.com', '_blank')">ðŸ’¬ Discord</button>
    <button onclick="window.open('https://chat.openai.com', '_blank')">ðŸ¤– ChatGPT</button>
    <button onclick="logout()">ðŸšª Logout</button>
  </div>
  <div class="iframe-container">
    <iframe id="app-frame"></iframe>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "https://keijxjexmfwlgetxyczr.supabase.co";
    const SUPABASE_ANON_KEY = "YOUR_ANON_KEY_HERE";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function loadUser() {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        window.location.href = "login.html";
        return;
      }
      const { data } = await supabase.from("profiles").select("username").eq("id", user.id).single();
      document.getElementById("username").textContent = `ðŸ‘¤ ${data?.username || "User"}`;
    }

    function openIframe(url) {
      const iframe = document.getElementById("app-frame");
      if (iframe.classList.contains("open") && iframe.src === url) {
        iframe.classList.remove("open");
      } else {
        iframe.src = url;
        iframe.classList.add("open");
      }
    }

    async function logout() {
      await supabase.auth.signOut();
      localStorage.clear();
      window.location.href = "login.html";
    }

    loadUser();
  </script>
</body>
</html>
